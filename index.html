<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Management System</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --background-color: #f4f6f7;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            background-color: var(--background-color);
            color: var(--primary-color);
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        #searchResults {
            margin-top: 20px;
        }

        .result-item {
            background-color: #f9f9f9;
            border-left: 4px solid var(--secondary-color);
            padding: 10px;
            margin-bottom: 10px;
        }

        .error-message {
            color: red;
            margin-bottom: 10px;
        }

        .success-message {
            color: green;
            margin-bottom: 10px;
        }

        @media screen and (max-width: 600px) {
            .container {
                width: 100%;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Document Management System</h1>

        <!-- Document Submission Section -->
        <div class="section">
            <h2>Submit Document</h2>
            <div id="submitErrorMessage" class="error-message"></div>
            <div id="submitSuccessMessage" class="success-message"></div>
            
            <input 
                type="text" 
                id="documentTitle" 
                placeholder="Document Title (Max 100 characters)" 
                maxlength="100" 
                required
            >
            <textarea 
                id="documentContent" 
                placeholder="Document Content (10-5000 characters)" 
                rows="5" 
                minlength="10" 
                maxlength="5000" 
                required
            ></textarea>
            <button onclick="documentManager.submitDocument()">Submit Document</button>
        </div>

        <!-- Document Search Section -->
        <div class="section">
            <h2>Search Documents</h2>
            <input 
                type="search" 
                id="searchInput" 
                placeholder="Search by title or content"
                oninput="documentManager.debounceSearch()"
            >
            <div id="searchResults"></div>
        </div>
    </div>

    <script>
    class DocumentManager {
        constructor() {
            // Replace with your actual Google Apps Script Web App URL
            this.API_ENDPOINT = 'https://script.google.com/macros/s/AKfycbz3jXo0VEU4LkhHEXnV8fZBc3AChV_FE6XtghhWveJEm6rGR_05Jc8e5lS2WMD70s9crQ/exec';
            this.searchTimeout = null;
        }

        clearMessages() {
            document.getElementById('submitErrorMessage').textContent = '';
            document.getElementById('submitSuccessMessage').textContent = '';
        }

        displayError(message) {
            this.clearMessages();
            const errorElement = document.getElementById('submitErrorMessage');
            errorElement.textContent = message;
        }

        displaySuccess(message) {
            this.clearMessages();
            const successElement = document.getElementById('submitSuccessMessage');
            successElement.textContent = message;
        }

        validateInput(title, content) {
            if (!title || title.trim().length === 0) {
                throw new Error('Title is required');
            }

            if (title.length > 100) {
                throw new Error('Title must be 100 characters or less');
            }

            if (!content || content.trim().length < 10) {
                throw new Error('Content must be at least 10 characters');
            }

            if (content.length > 5000) {
                throw new Error('Content must be 5000 characters or less');
            }
        }

        async submitDocument() {
            const titleElement = document.getElementById('documentTitle');
            const contentElement = document.getElementById('documentContent');
            
            const title = titleElement.value.trim();
            const content = contentElement.value.trim();

            try {
                // Validate input
                this.validateInput(title, content);

                // Prepare submission data
                const documentData = { title, content };

                // Submit document
                const response = await fetch(this.API_ENDPOINT, {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(documentData)
                });

                // Check response
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const result = await response.json();

                if (result.status === 'success') {
                    this.displaySuccess('Document submitted successfully!');
                    
                    // Clear input fields
                    titleElement.value = '';
                    contentElement.value = '';
                } else {
                    throw new Error(result.message || 'Submission failed');
                }

            } catch (error) {
                this.displayError(error.message);
                console.error('Submission error:', error);
            }
        }

        debounceSearch() {
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => this.searchDocuments(), 500);
        }

        async searchDocuments() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            const resultsDiv = document.getElementById('searchResults');

            if (searchTerm.length < 2) {
                resultsDiv.innerHTML = '';
                return;
            }

            resultsDiv.innerHTML = '<p>Searching...</p>';

            try {
                const response = await fetch(`${this.API_ENDPOINT}?q=${encodeURIComponent(searchTerm)}`);
                
                if (!response.ok) {
                    throw new Error('Search request failed');
                }

                const results = await response.json();

                if (results && results.length) {
                    resultsDiv.innerHTML = results.map(result => `
                        <div class="result-item">
                            <h3>${result[0]}</h3>
                            <p>${result[1].substring(0, 200)}${result[1].length > 200 ? '...' : ''}</p>
                        </div>
                    `).join('');
                } else {
                    resultsDiv.innerHTML = '<p>No results found.</p>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<p>Search failed. Please try again.</p>';
                console.error('Search error:', error);
            }
        }
    }

    const documentManager = new DocumentManager();
    </script>
</body>
</html>
